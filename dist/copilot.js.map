{"version":3,"sources":["webpack://Copilot/webpack/universalModuleDefinition","webpack://Copilot/./src/animation/smoothener.js","webpack://Copilot/./src/easing.js","webpack://Copilot/./src/event-emitter.js","webpack://Copilot/./src/frame.js","webpack://Copilot/./src/interpolators.js","webpack://Copilot/./src/manager.js","webpack://Copilot/./src/parsers/index.js","webpack://Copilot/./src/parsers/time.js","webpack://Copilot/./src/player.js","webpack://Copilot/./src/schema.js","webpack://Copilot/./src/syncher.js","webpack://Copilot/./src/timeline.js","webpack://Copilot/./src/transition.js","webpack://Copilot/./src/type.js","webpack://Copilot/./src/util/index.js","webpack://Copilot/webpack/bootstrap","webpack://Copilot/./src/index.js"],"names":["root","factory","exports","module","define","amd","self","manager","lastTime","duration","keys","easing","cubicOut","state","targetState","startState","startTime","endTime","smoothener","setState","newState","now","util","pick","update","timeFraction","getTimeFraction","getInterpolatedState","_schema","halfPi","Math","PI","Pi2","t","cos","sin","pow","makeElasticIn","a","p","s","asin","w","makeElasticOut","makeElasticInOut","elasticIn","elasticOut","elasticInOut","sqrt","reverse","makeBackIn","overshoot","makeBackOut","makeBackInOut","backIn","backOut","backInOut","makeStep","steps","step","getPriority","val","_priority_","EventEmitter","this","_topics","topic","fn","scope","priority","on","listeners","orig","bind","_bindfn_","_one_","_scope_","undefined","idx","sortedIndex","splice","off","i","l","length","listn","data","e","handler","one","meta","defaultMetaOptions","Error","defaults","ret","key","META_PARSERS","parseMeta","$meta","DEFAULT_FRAME_META","percentDuration","pctReg","exec","implicit","fractionalDuration","parseFloat","time","timeParser","v","test","shortestModDist","a0","a1","modulo","from","to","lerp","len","map","v1","mapProperties","substr","makeToggle","threshold","toggle","DEFAULT_OPTIONS","defaultTransitionDuration","meddleTimeout","meddleRelaxDuration","meddleRelaxDelay","DEFAULT_MEDDLE","schema","options","framesById","frames","timeline","createSchema","_defaultState","createState","_state","_prevState","Object","assign","unmeddle","totalTime","frame","createFrame","id","push","refreshTimeline","_updateState","createTimeline","name","meddleState","meddleOpts","relaxDuration","relaxDelay","freeze","meddle","_meddles","relaxState","active","linear","m","forEach","k","min","emit","getStateAt","reduce","_assignMeddleState","meddleTransitionState","mergeIntersecting","transition","transitions","getTransitionsAtTime","getStartState","reduceTransitions","frameId","getFrame","seek","strOrNumber","parsed","match","timeStdReg","getTime","timeDecReg","unit","toLowerCase","h","round","config","Player","PlayerStack","window","requestAnimationFrame","playbackRate","_clockTime","_time","_paused","attach","max","togglePause","indexOf","updateTime","paused","_playToTime","_oldPlaybackRate","play","clockTime","dt","schemaDef","props","prop","def","DEFAULT_EASING","interpolator","interpolatorOpts","type","cfg","defaultVal","getType","getTypeCfg","isExplicit","default","isPlaying","onFrame","getPlaybackRate","timeStarted","stop","lastClockTime","syncTime","isPlayingVal","abs","destroy","defaultState","implicitFrames","filter","f","sort","b","start","end","prevEndTime","getPrevEndTime","prevState","createTransitionFromFrame","endState","conflicts","getConflictingFrames","paths","JSON","stringify","markers","j","getIntersectingPaths","currTime","ep","initialState","tr","progress","previousState","nextState","interpolateProperty","frac","clamp","opts","CUSTOM_TYPES","Number","Boolean","String","Array","isArray","NATIVE_TYPES","Interpolators","string","array","object","identity","process","hrtime","performance","Date","thing","obj","out","first","second","value","callback","retHighest","low","high","mid","computed","o1","o2","prototype","hasOwnProperty","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","Copilot","Manager","Util","Easing","Syncher","Parsers","registerType","Animation","Smoothener","ENUM"],"mappings":"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","file":"copilot.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Copilot\"] = factory();\n\telse\n\t\troot[\"Copilot\"] = factory();\n})(self, function() {\nreturn ","import * as util from '@/util'\nimport { cubicOut } from '@/easing'\nimport { getTimeFraction, getInterpolatedState } from '@/transition'\n\n// Helper to smooth state changes\n// let smooth = Smoothener( frames )\n// smooth.setState( state ) // when state changed\n// state = smooth.update() // when animation frame\n// ---------------------------------------\n\nexport function Smoothener(\n  manager\n  , {\n    duration = 80\n    , keys = null\n    , easing = cubicOut\n  } = {}\n){\n  let state = manager.state\n  let targetState = state\n  let startState = state\n  let startTime = 0\n  let endTime = -1\n  let lastTime\n  const smoothener = {\n    duration\n    , easing\n    , get state(){ return state }\n  }\n\n  smoothener.setState = function( newState ){\n    const now = util.now()\n\n    startTime = lastTime || now\n    endTime = startTime + smoothener.duration\n    targetState = util.pick( newState, keys )\n\n    startState = { ...state }\n  }\n\n  smoothener.update = function(){\n    const now = util.now()\n\n    if ( now > endTime ){\n      lastTime = now\n      state = targetState\n      return state\n    }\n\n    if ( lastTime === now ){\n      return state\n    }\n\n    lastTime = now\n\n    const timeFraction = getTimeFraction(\n      startTime\n      , endTime\n      , now\n    )\n\n    state = getInterpolatedState(\n      manager._schema\n      , startState\n      , targetState\n      , timeFraction\n      , smoothener.easing\n    )\n\n    return state\n  }\n\n  return smoothener\n}\n","/**\n * Easing adapted from phaser\n * license: https://opensource.org/licenses/MIT\n */\n\nconst halfPi = Math.PI / 2\nconst Pi2 = Math.PI * 2\n\nexport const linear = t => t\nexport const quadIn = t => t * t\nexport const quadOut = t => t * (2 - t)\nexport const quadInOut = t => ((t *= 2) < 1 ? 0.5 * t * t : -0.5 * (--t * (t - 2) - 1))\nexport const cubicIn = t => t * t * t\nexport const cubicOut = t => --t * t * t + 1\nexport const cubicInOut = t =>\n  (t *= 2) < 1 ? 0.5 * t * t * t : 0.5 * ((t -= 2) * t * t + 2)\nexport const quartIn = t => t * t * t * t\nexport const quartOut = t => 1 - (--t * t * t * t)\nexport const quartInOut = t =>\n  (t *= 2) < 1 ? 0.5 * t * t * t * t : -0.5 * ((t -= 2) * t * t * t - 2)\nexport const quintIn = t => t * t * t * t * t\nexport const quintOut = t => --t * t * t * t * t + 1\nexport const quintInOut = t =>\n  (t *= 2) < 1 ? 0.5 * t * t * t * t * t : 0.5 * ((t -= 2) * t * t * t * t + 2)\nexport const sinIn = t => 1 - Math.cos(t * halfPi)\nexport const sinOut = t => Math.sin(t * halfPi)\nexport const sinInOut = t => 0.5 * (1 - Math.cos(Math.PI * t))\nexport const expIn = t => t === 0 ? 0 : Math.pow(1024, t - 1)\nexport const expOut = t => t === 0 ? 1 : 1 - Math.pow(1024, -t)\nexport const expInOut = t => {\n  if (t === 0) return 0\n  if (t === 1) return 1\n  if ((t *= 2) < 1) return 0.5 * Math.pow(1024, t - 1)\n  return 0.5 * (2 - Math.pow(1024, 1 - t))\n}\n\n/*\n * @param {number} [amplitude=0.1] - The amplitude of the elastic ease.\n * @param { number } [period = 0.1] - Sets how tight the sine - wave is,\n * where smaller values are tighter waves, which result in more cycles.\n */\nexport const makeElasticIn = (a = 0.1, p = 0.1) => {\n  let s = p / 4\n\n  if (a < 1){\n    a = 1\n  } else {\n    s = p * Math.asin(1 / a) / Pi2\n  }\n\n  const w = Pi2 / p\n\n  return t => {\n    if (t === 0) return 0\n    if (t === 1) return 1\n    return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * w))\n  }\n}\n\n/*\n * @param {number} [amplitude=0.1] - The amplitude of the elastic ease.\n * @param { number } [period = 0.1] - Sets how tight the sine - wave is,\n * where smaller values are tighter waves, which result in more cycles.\n */\nexport const makeElasticOut = (a = 0.1, p = 0.1) => {\n  let s = p / 4\n\n  if (a < 1) {\n    a = 1\n  } else {\n    s = p * Math.asin(1 / a) / Pi2\n  }\n\n  const w = Pi2 / p\n\n  return t => {\n    if (t === 0) return 0\n    if (t === 1) return 1\n    return (a * Math.pow(2, -10 * t) * Math.sin((t - s) * w) + 1)\n  }\n}\n\n/*\n * @param {number} [amplitude=0.1] - The amplitude of the elastic ease.\n * @param { number } [period = 0.1] - Sets how tight the sine - wave is,\n * where smaller values are tighter waves, which result in more cycles.\n */\nexport const makeElasticInOut = (a = 0.1, p = 0.1) => {\n  let s = p / 4\n\n  if (a < 1) {\n    a = 1\n  } else {\n    s = p * Math.asin(1 / a) / Pi2\n  }\n\n  const w = Pi2 / p\n\n  return t => {\n    if (t === 0) return 0\n    if (t === 1) return 1\n    if ((t *= 2) < 1) {\n      return -0.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - s) * w))\n    } else {\n      return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - s) * w) * 0.5 + 1\n    }\n  }\n}\n\nexport const elasticIn = makeElasticIn()\nexport const elasticOut = makeElasticOut()\nexport const elasticInOut = makeElasticInOut()\n\nexport const circularIn = t => 1 - Math.sqrt(1 - t * t)\nexport const circularOut = t => Math.sqrt(1 - (--t * t))\nexport const circularInOut = t =>\n  (t *= 2) < 1 ?\n    -0.5 * (Math.sqrt(1 - t * t) - 1) :\n    0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1)\n\nexport const bounceIn = t => {\n  t = 1 - t\n  if (t < 1 / 2.75) return 1 - (7.5625 * t * t)\n  else if (t < 2 / 2.75) return 1 - (7.5625 * (t -= 1.5 / 2.75) * t + 0.75)\n  else if (t < 2.5 / 2.75) return 1 - (7.5625 * (t -= 2.25 / 2.75) * t + 0.9375)\n  else return 1 - (7.5625 * (t -= 2.625 / 2.75) * t + 0.984375)\n}\n\nexport const bounceOut = t => {\n  if (t < 1 / 2.75) return 7.5625 * t * t\n  else if (t < 2 / 2.75) return 7.5625 * (t -= 1.5 / 2.75) * t + 0.75\n  else if (t < 2.5 / 2.75) return 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375\n  else return 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375\n}\n\nexport const bounceInOut = t => {\n  let reverse = false\n  if (t < 0.5) {\n    t = 1 - (t * 2)\n    reverse = true\n  } else {\n    t = (t * 2) - 1\n  }\n\n  if (t < 1 / 2.75) {\n    t = 7.5625 * t * t\n  } else if (t < 2 / 2.75) {\n    t = 7.5625 * (t -= 1.5 / 2.75) * t + 0.75\n  } else if (t < 2.5 / 2.75) {\n    t = 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375\n  } else {\n    t = 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375\n  }\n\n  if (reverse) {\n    return (1 - t) * 0.5\n  } else {\n    return t * 0.5 + 0.5\n  }\n}\n\nexport const makeBackIn = (overshoot = 1.70158) => t =>\n  t * t * ((overshoot + 1) * t - overshoot)\n\nexport const makeBackOut = (overshoot = 1.70158) => t =>\n  --t * t * ((overshoot + 1) * t + overshoot) + 1\n\nexport const makeBackInOut = (overshoot = 1.70158) => t => {\n  const s = overshoot * 1.525;\n\n  if ((t *= 2) < 1) {\n    return 0.5 * (t * t * ((s + 1) * t - s))\n  } else {\n    return 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2)\n  }\n}\n\nexport const backIn = makeBackIn()\nexport const backOut = makeBackOut()\nexport const backInOut = makeBackInOut()\n\nexport const makeStep = (steps = 1) => t => (((steps * t) | 0) + 1) * (1 / steps)\nexport const step = makeStep()\n","import { sortedIndex } from '@/util'\n\nconst defaultPriority = 1\n\nfunction getPriority( val ){\n  return val._priority_\n}\n\nexport default class EventEmitter {\n  constructor(){\n    // ensure topics hash is initialized\n    this._topics = this._topics || (this._topics = {})\n  }\n\n  /**\n  * EventEmitter#on( topic, fn( data, event )[, scope, priority] ) -> this\n  * EventEmitter#on( topicConfig[, scope, priority] ) -> this\n  * - topic (String): The topic name\n  * - topicConfig (Object): A config with key/value pairs of `{ topic: callbackFn, ... }`\n  * - fn (Function): The callback function (if not using Object as previous argument)\n  * - data (Mixed): The data sent from the call to `.emit()`\n  * - event (Object): Event data, holding `.topic`, the topic, and `.handler`, the `fn` callback.\n  * - scope (Object): The scope to bind callback to\n  * - priority (Number): The priority of the callback (higher is earlier)\n  *\n  * Subscribe callback(s) to a topic(s).\n  **/\n  on( topic, fn, scope, priority ){\n    // check if we're subscribing to multiple topics\n    // with an object\n    if ( typeof topic === 'object' ){\n\n      for ( const t in topic ){\n        this.on( t, topic[t], fn, scope )\n      }\n\n      return this\n    }\n\n    const listeners = this._topics[topic] || (this._topics[topic] = [])\n    const orig = fn\n\n    if ( typeof scope === 'object' ){\n\n      fn = fn.bind( scope )\n      fn._bindfn_ = orig\n      fn._one_ = orig._one_\n      fn._scope_ = scope\n\n    } else if ( priority === undefined ) {\n\n      priority = scope\n    }\n\n    fn._priority_ = priority === undefined ? defaultPriority : priority\n\n    const idx = sortedIndex( listeners, fn, getPriority )\n\n    listeners.splice( idx, 0, fn )\n    return this\n  }\n\n  /**\n  * EventEmitter#off( topic, fn[, scope] ) -> this\n  * EventEmitter#off( topicCfg ) -> this\n  * - topic (String): topic The topic name. Specify `true` to remove all listeners for all topics\n  * - topicCfg (Object): A config with key/value pairs of `{ topic: callbackFn, ... }`\n  * - fn (Function): The original callback function. Specify `true` to remove all listeners for specified topic\n  * - scope (Object): The scope the callback was bound to. This is important if you are\n  *   binding methods that come from object prototypes.\n  *\n  * Unsubscribe callback(s) from topic(s).\n  **/\n  off( topic, fn, scope ){\n    if ( topic === true ){\n      // purge all listeners\n      this._topics = {}\n      return this\n    }\n\n    // check if we're subscribing to multiple topics\n    // with an object\n    if ( typeof topic === 'object' ){\n\n      for ( const t in topic ){\n\n        this.off( t, topic[t] )\n      }\n\n      return this\n    }\n\n    const listeners = this._topics[topic]\n\n    if (!listeners){\n      return this\n    }\n\n    if ( fn === true ){\n      // purge all listeners for topic\n      this._topics[topic] = []\n      return this\n    }\n\n    for ( let i = 0, l = listeners.length; i < l; i++ ){\n      const listn = listeners[i]\n\n      if (\n        (listn._bindfn_ === fn || listn === fn) &&\n        ( (!scope) || listn._scope_ === scope) // check the scope too if specified\n      ){\n        listeners.splice( i, 1 )\n        break\n      }\n    }\n\n    return this\n  }\n\n  /**\n  * EventEmitter#emit( topic[, data] ) -> this\n  * - topic (String): The topic name\n  * - data (Mixed): The data to send\n  *\n  * Publish data to a topic.\n  **/\n  emit( topic, data ){\n\n    const listeners = this._topics[topic]\n    let l = listeners && listeners.length\n\n    if ( !l ){\n      return this\n    }\n\n    const e = {}\n    // event data\n    e.topic = topic\n\n    // reverse iterate so priorities work out correctly\n    while ( l-- ){\n\n      const handler = listeners[l]\n      handler( data, e )\n\n      // if _one_ flag is set, the unsubscribe\n      if ( handler._one_ ){\n        listeners.splice( l, 1 )\n      }\n    }\n\n    return this\n  }\n\n  /**\n  * EventEmitter#one( topic, fn( data, event )[, scope, priority] ) -> this\n  * EventEmitter#one( topicConfig[, scope, priority] ) -> this\n  * - topic (String): The topic name\n  * - topicConfig (Object): A config with key/value pairs of `{ topic: callbackFn, ... }`\n  * - fn (Function): The callback function (if not using Object as previous argument)\n  * - data (Mixed): The data sent from the call to `.emit()`\n  * - event (Object): Event data, holding `.topic`, the topic, and `.handler`, the `fn` callback.\n  * - scope (Object): The scope to bind callback to\n  * - priority (Number): The priority of the callback (higher is earlier)\n  *\n  * Subscribe callback(s) to a topic(s), but only ONCE.\n  **/\n  one( topic, fn, scope ){\n\n    // check if we're subscribing to multiple topics\n    // with an object\n    if ( typeof topic === 'object' ){\n\n      for ( const t in topic ){\n\n        this.one( t, topic[t], fn, scope )\n      }\n\n      return this\n    }\n\n    // set the _one_ flag\n    fn._one_ = true\n    this.on( topic, fn, scope )\n\n    return this\n  }\n}\n","import { timeParser } from '@/parsers/time'\n\nconst pctReg = /^((\\d{1,3})(\\.\\d*)?)%$/\nconst DEFAULT_FRAME_META = { time: 0 }\nconst META_PARSERS = {\n  time: timeParser\n  , startTime: timeParser\n  , duration( v ){\n    if ( v === undefined ){ return undefined }\n    if ( pctReg.test(v) ){ return v }\n    return timeParser(v)\n  }\n}\n\n// parse meta to standardized format\nfunction parseMeta( meta, defaults ){\n  const ret = { ...defaults, ...meta } // clone\n\n  for ( const key in META_PARSERS ){\n    ret[key] = META_PARSERS[key]( ret[key] )\n  }\n\n  return ret\n}\n\nexport function createFrame( state, meta, defaultMetaOptions ){\n  if ( !state ){\n    throw new Error('Can not create frame without state object')\n  }\n\n  state = { ...state }\n  meta = parseMeta( meta || state.$meta, { ...defaultMetaOptions, ...DEFAULT_FRAME_META } )\n\n  delete state.$meta\n\n  const percentDuration = pctReg.exec(meta.duration)\n\n  if ( percentDuration ){\n    meta.implicit = true\n    meta.fractionalDuration = parseFloat(percentDuration[1]) / 100\n  } else {\n    if ( meta.startTime !== undefined ){\n      meta.duration = meta.time - meta.startTime\n    } else {\n      meta.startTime = meta.time - meta.duration\n    }\n  }\n\n  return {\n    state\n    , meta\n  }\n}\n","import { lerp, mapProperties } from '@/util'\n\nconst Pi2 = Math.PI * 2\n\nfunction shortestModDist( a0, a1, modulo ) {\n  // let moduloBy2 = 0.5 * modulo\n  const da = (a1 - a0) % modulo\n\n  return (da - modulo) % modulo\n}\n\nexport const linear = (from, to, t) => lerp(from, to, t)\nexport const makeCyclic = len => (from, to, t) => from + shortestModDist(from, to, len) * t\nexport const angle = (from, to, t) => from + shortestModDist(from, to, Pi2) * t\nexport const array = (from, to, t) => to.map((v1, idx) => lerp(from[idx] || 0, v1 || 0, t))\nexport const object = (from, to, t) =>\n  mapProperties(from, (val, key) =>\n    lerp(val, to[key], t)\n  )\n\nexport const string = (from, to, t) => {\n  if (t <= 0) { return from }\n\n  const length = lerp(0, to.length, t) | 0 // to integer\n\n  return to.substr(0, length)\n}\n\nexport const makeToggle = threshold => (from, to, t) => (t > threshold) ? to : from\nexport const toggle = makeToggle(0.5)\n","import * as util from '@/util'\nimport { linear } from '@/easing'\nimport { createSchema, createState } from '@/schema'\nimport { getTimeFraction, getInterpolatedState } from '@/transition'\nimport { createFrame } from '@/frame'\nimport { timeParser } from '@/parsers/time'\nimport {\n  getTransitionsAtTime\n  , createTimeline\n  , reduceTransitions\n  , getStartState\n} from '@/timeline'\nimport EventEmitter from '@/event-emitter'\n\nconst DEFAULT_OPTIONS = {\n  defaultTransitionDuration: 1000\n  , meddleTimeout: 2000\n  , meddleRelaxDuration: 500\n  , meddleRelaxDelay: 1000\n}\n\nconst DEFAULT_MEDDLE = '__DEFAULT__'\n\nexport default class extends EventEmitter {\n  constructor( schema, options ){\n    super()\n\n    this.time = 0\n    this.framesById = {}\n    this.frames = []\n    this.timeline = []\n\n    this._schema = createSchema( schema )\n    this._defaultState = createState( this._schema )\n    this._state = { ...this._defaultState }\n    this._prevState = { ...this._defaultState }\n\n    this.options = Object.assign({}, DEFAULT_OPTIONS, options)\n    // reset\n    this.unmeddle()\n  }\n\n  get state(){\n    return this._state\n  }\n\n  get totalTime(){\n    return this.timeline[this.timeline.length - 1].time\n  }\n\n  get progress(){\n    return this.time / this.totalTime * 100\n  }\n\n  // add a frame\n  add( state, meta ){\n\n    const frame = createFrame(state, meta, {\n      duration: this.options.defaultTransitionDuration\n    })\n\n    if ( frame.meta.id && this.framesById[frame.meta.id] ){\n      throw new Error(`Frame with id \"${frame.meta.id}\" already defined`)\n    }\n\n    // add to id list\n    if ( frame.meta.id ){\n      this.framesById[frame.meta.id] = frame\n    }\n\n    this.frames.push( frame )\n    this.refreshTimeline()\n    this._updateState()\n    return this\n  }\n\n  refreshTimeline(){\n    this.timeline = createTimeline( this._schema, this.frames )\n    return this\n  }\n\n  // toggle user meddling\n  meddle( name, meddleState, meddleOpts = {} ){\n    if ( typeof name !== 'string' ){\n      meddleOpts = meddleState\n      meddleState = name\n      name = DEFAULT_MEDDLE\n    }\n\n    let { relaxDuration, relaxDelay, freeze, easing } = meddleOpts\n\n    relaxDelay = relaxDelay !== undefined ? relaxDelay : this.options.meddleRelaxDelay\n    relaxDuration = relaxDuration !== undefined ? relaxDuration : this.options.meddleRelaxDuration\n\n    let meddle = this._meddles[name]\n\n    if ( !meddle ){\n      meddle = this._meddles[name] = { state: {} }\n    }\n\n    meddle.state = { ...meddle.state, ...meddleState }\n\n    meddle.startTime = false\n    meddle.relaxState = null\n    meddle.active = true\n    meddle.freeze = freeze\n    meddle.relaxDelay = relaxDelay\n    meddle.relaxDuration = relaxDuration\n    meddle.easing = easing || linear\n\n    this._updateState()\n    return this\n  }\n\n  // force meddling to reset\n  unmeddle( name ){\n    if ( !name ){\n      this._meddles = {}\n      return this\n    }\n\n    delete this._meddles[name]\n\n    return this\n  }\n\n  // toggle freezing of meddle states\n  freeze( toggle = true, name = DEFAULT_MEDDLE ){\n\n    if ( name !== true ){\n      const m = this._meddles[name]\n\n      if ( m ){\n        m.freeze = toggle\n      }\n\n      return this\n    }\n\n    Object.keys(this._meddles).forEach( k => {\n      const m = this._meddles[k]\n\n      m.freeze = toggle\n    })\n\n    return this\n  }\n\n  getFrame( id ){\n    const frame = this.framesById[id]\n\n    return frame\n  }\n\n  seek( time ){\n    time = timeParser( time )\n    this.time = Math.min(time, this.totalTime)\n\n    this._updateState()\n    this.emit('seek')\n    return this\n  }\n\n  _updateState(){\n    const state = this.getStateAt( this.time )\n\n    Object.keys( this._meddles ).reduce( (state, name) =>\n      this._assignMeddleState( state, name )\n    , state)\n    // set state\n    this._prevState = this._state\n    this._state = state\n    this.emit('update')\n  }\n\n  _assignMeddleState( state, name ){\n    const meddle = this._meddles[name || DEFAULT_MEDDLE]\n\n    // check meddling\n    if ( !meddle.active ){\n      return state\n    }\n\n    if ( meddle.freeze ){\n      return Object.assign( state, meddle.state )\n    }\n\n    if ( meddle.startTime === false ){\n      meddle.startTime = this.time\n      meddle.endTime = meddle.startTime + meddle.relaxDelay + meddle.relaxDuration\n      meddle.relaxState = util.pick(\n        this.getStateAt( meddle.endTime )\n        , Object.keys(meddle.state)\n      )\n    }\n\n    if ( this.time >= meddle.endTime || this.time < meddle.startTime ){\n      // meddling is over\n      this.unmeddle(name)\n    }\n\n    if ( this.time > this.totalTime ){\n      // this will force a reset when the timeline is re-entered\n      this.unmeddle(name)\n    }\n\n    const timeFraction = getTimeFraction(\n      meddle.startTime + meddle.relaxDelay\n      , meddle.endTime\n      , this.time\n    )\n\n    const meddleTransitionState = getInterpolatedState(\n      this._schema\n      , meddle.state\n      , util.mergeIntersecting( meddle.relaxState, state )\n      , timeFraction\n      , meddle.easing\n    )\n\n    Object.assign( state, meddleTransitionState )\n\n    return state\n  }\n\n  getStateAt( time ){\n    if ( time >= this.totalTime ){\n      const m = this.timeline[this.timeline.length - 1]\n      const t = m.transition\n\n      return { ...m.state, ...t.relaxState }\n    }\n\n    const transitions = getTransitionsAtTime( this.timeline, time )\n    const startState = getStartState( this.timeline, time, this._defaultState )\n\n    return reduceTransitions( this._schema, transitions, time, startState )\n  }\n\n  to( frameId ){\n    const frame = this.getFrame( frameId )\n\n    return this.seek( frame.meta.time )\n  }\n\n  getTransitions( time ){\n    time = time || this.time\n    return getTransitionsAtTime( this.timeline, time )\n  }\n}\n","import * as timeParsers from './time'\n\nexport default {\n  ...timeParsers\n}\n","const timeDecReg = /([0-9.]+)(s|m|h)?/\nconst timeStdReg = /((\\d\\d):)?((\\d\\d):(\\d\\d))/\nconst MINUTES = 60\nconst HOURS = 60 * 60\n\nfunction getTime( h, m, s ){\n  h = parseFloat( h || 0 )\n  m = parseFloat( m || 0 )\n  s = parseFloat( s || 0 )\n  return Math.round( (h * HOURS + m * MINUTES + s) * 1000 ) // integer\n}\n\n// returns parsed time in ms\nexport function timeParser( strOrNumber ){\n  if ( typeof strOrNumber !== 'string' ){\n    return strOrNumber\n  }\n\n  let parsed = strOrNumber.match(timeStdReg)\n\n  if ( parsed ){\n    return getTime( parsed[2], parsed[4], parsed[5] )\n  }\n\n  parsed = strOrNumber.match(timeDecReg)\n\n  if ( parsed ){\n    const unit = ('' + parsed[2]).toLowerCase()\n\n    if ( !parsed[1] || unit === 's' ){\n      return getTime( 0, 0, parsed[1] )\n    }\n\n    if ( unit === 'm' ){\n      return getTime( 0, parsed[1], 0 )\n    }\n\n    if ( unit === 'h' ){\n      return getTime( parsed[1], 0, 0 )\n    }\n  }\n\n  return 0\n}\n","// Helper for managing play state\n//\n// ---------------------------------------\n\nimport * as util from '@/util'\nimport { timeParser } from '@/parsers/time'\nimport EventEmitter from '@/event-emitter'\n\nconst PlayerStack = []\n\nfunction step(){\n  window.requestAnimationFrame( step )\n  const now = util.now()\n\n  for ( let l = PlayerStack.length, i = 0; i < l; i++ ){\n    PlayerStack[i].step( now )\n  }\n}\n\nstep()\n\nclass Player extends EventEmitter {\n  constructor( { totalTime = 0, playbackRate = 1, manager } = {} ){\n    super()\n\n    this.totalTime = timeParser( totalTime )\n    this._clockTime = util.now()\n    this._time = 0\n    this.playbackRate = playbackRate\n    this._paused = true\n\n    if ( manager ){\n      this.attach(manager)\n    }\n\n    PlayerStack.push( this )\n  }\n\n  get progress(){\n    return this.totalTime > 0 ? this._time / this.totalTime * 100 : 0\n  }\n\n  set progress(p){\n    this.seek(Math.max(0, p) * this.totalTime / 100)\n  }\n\n  get time(){\n    return this._time\n  }\n\n  set time(t){\n    this.seek(t)\n  }\n\n  get paused(){\n    return this._paused\n  }\n\n  set paused(p){\n    this.togglePause(p)\n  }\n\n  destroy(){\n    this.off(true)\n    const idx = PlayerStack.indexOf(this)\n    PlayerStack.splice(idx, 1)\n    this.emit('destroy')\n  }\n\n  // attach a copilot manager\n  attach( manager ){\n    const updateTime = () => {\n      this.totalTime = manager.totalTime\n    }\n\n    this.on('update', () => {\n      manager.seek(this.time)\n    })\n\n    manager.on('update', updateTime)\n\n    this.on('destroy', () => {\n      manager.off('update', updateTime)\n    })\n\n    updateTime()\n    return this\n  }\n\n  togglePause( paused ){\n    if ( paused === undefined ){\n      paused = !this._paused\n    }\n\n    this._paused = !!paused\n\n    if ( this._paused ){\n      this.emit('pause')\n    } else {\n      this.emit('play')\n    }\n\n    this.emit('togglePause')\n\n    return this\n  }\n\n  pause(){\n    return this.togglePause(true)\n  }\n\n  play(){\n    return this.togglePause(false)\n  }\n\n  // Stops after it reaches time t\n  playTo(time){\n    if (this._time === time){\n      this.seek(time)\n      return this\n    }\n\n    this._playToTime = time\n    this._oldPlaybackRate = this.playbackRate\n    this.playbackRate = (time >= this._time) ? 1 : -1\n    return this.play()\n  }\n\n  seek( time ){\n    this._time = time\n\n    this.emit('update', time)\n    this.emit('seek', time)\n    return this\n  }\n\n  step( now ){\n    const clockTime = this._clockTime\n    const playbackRate = this.playbackRate\n    const dt = now - clockTime\n    let time = this._time\n    const totalTime = this.totalTime\n\n    this._clockTime = now\n\n    this.emit('animate', now)\n\n    // if it's paused, don't step\n    if ( this._paused ){\n      return this\n    }\n\n    time += dt * playbackRate\n\n    // enable stopping at playToTime\n    if (\n      this._playToTime !== false &&\n      (playbackRate * time >= playbackRate * this._playToTime)\n    ){\n      this.togglePause(true)\n      time = this._playToTime\n      this.playbackRate = this._oldPlaybackRate\n      this._playToTime = false\n    }\n\n    if ( playbackRate > 0 && time >= totalTime ){\n      time = totalTime\n      this.togglePause( true )\n      this.emit('end')\n    } else if ( playbackRate < 0 && time <= 0 ){\n      time = 0\n      this.togglePause( true )\n      this.emit('end')\n    }\n\n    this._time = time\n    this.emit('update', time)\n    this.emit('playback', time)\n\n    return this\n  }\n}\n\nexport default function( config ){\n  return new Player( config )\n}\n","import { linear } from '@/easing'\nimport { isExplicit, getType, getTypeCfg } from '@/type'\n\nconst DEFAULT_EASING = linear\n\nexport function createSchema( schemaDef ){\n  const schema = {}\n  const props = Object.keys( schemaDef )\n\n  for ( const prop of props ){\n    const def = schemaDef[prop]\n    let easing = DEFAULT_EASING\n    let interpolator = null\n    const interpolatorOpts = def.interpolatorOpts || {}\n    let type\n    let cfg\n    let defaultVal\n\n    if ( typeof def === 'object' && def.type !== undefined ){\n      type = getType( def.type )\n      cfg = getTypeCfg( type )\n      if ( !cfg ){\n        throw new Error(`Unrecognized type ${type}`)\n      }\n\n      if ( isExplicit( type, def.type ) ){\n        defaultVal = def.default || cfg.default\n      } else {\n        defaultVal = def.type\n      }\n\n      easing = def.easing || DEFAULT_EASING\n      interpolator = def.interpolator || cfg.interpolator\n\n    } else {\n      if ( typeof def === 'string' ){\n        type = 'string'\n      } else {\n        type = getType( def )\n      }\n\n      cfg = getTypeCfg( type )\n      if ( !cfg ){\n        throw new Error(`Unrecognized type ${type}`)\n      }\n\n      easing = def.easing || DEFAULT_EASING\n      interpolator = cfg.interpolator\n      defaultVal = isExplicit( type, def ) ? cfg.default : def\n    }\n\n    schema[prop] = {\n      type\n      , easing\n      , default: defaultVal\n      , interpolator: interpolator\n      , interpolatorOpts\n      , def\n    }\n  }\n\n  return schema\n}\n\nexport function createState( schema ){\n  const state = {}\n  const props = Object.keys( schema )\n\n  for ( const prop of props ){\n    state[prop] = schema[prop].default\n  }\n\n  return state\n}\n","import * as util from '@/util'\n\nexport default function Syncher( {\n  getTime\n  , isPlaying\n  , onFrame\n  , getPlaybackRate = () => 1\n  , threshold = 5000 / 60 // 5 frames\n} = {} ){\n  if ( !getTime ){\n    throw new Error('Must call Syncher with a \"getTime\" function')\n  }\n  if ( !isPlaying ){\n    throw new Error('Must call Syncher with a \"isPlaying\" function')\n  }\n  if ( !onFrame ){\n    throw new Error('Must call Syncher with a \"onFrame\" function')\n  }\n\n  let stop = false\n  let lastClockTime = 0\n  let timeStarted\n  let lastTime = 0\n  const update = () => {\n    if ( stop ){ return }\n    window.requestAnimationFrame( update )\n\n    const now = util.now()\n    const syncTime = getTime() || 0\n    const isPlayingVal = !!isPlaying()\n    const playbackRate = +getPlaybackRate()\n    let time\n\n    if ( !isPlayingVal || !timeStarted ){\n      timeStarted = syncTime\n      time = syncTime\n    } else {\n      // extrapolate\n      const dt = (now - lastClockTime) * playbackRate\n\n      time = lastTime + dt\n\n      if ( Math.abs(time - syncTime) > threshold ){\n        // resync\n        time = syncTime\n        timeStarted = time\n      }\n    }\n\n    lastClockTime = now\n    lastTime = time\n    onFrame( time, now, { syncTime, isPlaying: isPlayingVal, playbackRate } )\n  }\n\n  update()\n\n  function destroy(){\n    stop = true\n  }\n\n  return destroy\n}\n","import * as util from '@/util'\nimport { createState } from '@/schema'\nimport { getInterpolatedState, createTransitionFromFrame, getTimeFraction } from '@/transition'\n\n// Check for conflicting overlaps\n// ---------------------------------------\nfunction getConflictingFrames( timeline ){\n  const markers = []\n  let idx\n\n  for ( let l = timeline.length, i = 0; i < l; i++ ){\n    const m = timeline[i]\n\n    if ( m.type === 'start' ){\n      markers.push( m )\n    } else {\n      // stop tracking its partner\n      idx = markers.indexOf( m.start )\n      markers.splice( idx, 1 )\n    }\n\n    for ( let l = markers.length, i = 0; i < l; i++ ){\n      const m = markers[i]\n\n      for ( let j = i + 1; j < l; j++ ){\n        const paths = util.getIntersectingPaths(\n          m.transition.endState\n          , markers[j].transition.endState\n        )\n\n        if ( paths.length ){\n          return {\n            paths\n            , frames: [\n              m.frame\n              , markers[j].frame\n            ]\n          }\n        }\n      }\n    }\n  }\n\n  return false\n}\n\nfunction getPrevEndTime( timeline, idx, currTime ){\n  for ( let i = idx - 1; i >= 0; i-- ){\n    const ep = timeline[i]\n\n    // loop until previous end marker is found.\n    // if they have the same end time, ignore\n    if ( ep.type === 'end' && currTime !== ep.time ){\n      return ep.time\n    }\n  }\n\n  return 0\n}\n\n// Create a timeline array from specified frames\n// ---------------------------------------\nexport function createTimeline( schema, frames = [] ){\n\n  // timeline is an array of\n  // marker = {\n  //   type: 'start' | 'end'\n  //   , time: Number\n  //   , frame: {...}\n  //   , start|end: <the other transiton>\n  // }\n\n  if ( !frames.length ){ return [] }\n\n  const getTime = v => v.time\n  const defaultState = createState( schema )\n  const timeline = []\n\n  // omit frames that are implicitly defined first\n  const implicitFrames = frames.filter( f => f.meta.implicit ).sort( (a, b) => a.meta.time - b.meta.time )\n\n  frames = frames.filter( f => !f.meta.implicit )\n\n  frames.forEach( frame => {\n    let idx\n    const start = { type: 'start', frame, time: frame.meta.time - frame.meta.duration }\n    const end = { type: 'end', frame, time: frame.meta.time }\n\n    start.end = end\n    end.start = start\n\n    idx = util.sortedIndex( timeline, end, getTime )\n    timeline.splice( idx, 0, end )\n\n    // \"start\"s need to be after \"end\"s of equal time\n    idx = util.sortedIndex( timeline, start, getTime, true )\n    timeline.splice( idx, 0, start )\n  })\n\n  // TODO: is this necessary?\n  // timeline.sort( (a, b) => {\n  //   if ( a.time === b.time ){\n  //     return a.type > b.type ? 1 : -1\n  //   }\n  //\n  //   return 0\n  // })\n\n  // insert frames with implicit timing\n  implicitFrames.forEach( frame => {\n    const end = { type: 'end', frame, time: frame.meta.time }\n    let idx = util.sortedIndex( timeline, end, getTime )\n    const prevEndTime = getPrevEndTime( timeline, idx, end.time )\n    const startTime = util.lerp( end.time, prevEndTime, frame.meta.fractionalDuration )\n    const start = { type: 'start', frame, time: startTime }\n\n    start.end = end\n    end.start = start\n\n    // add the end\n    timeline.splice( idx, 0, end )\n    // \"start\"s need to be after \"end\"s of equal time\n    idx = util.sortedIndex( timeline, start, getTime, true )\n    timeline.splice( idx, 0, start )\n  })\n\n  // assign inherited states\n  let prevState = defaultState\n\n  timeline.forEach( (m, idx) => {\n    // only go through ends\n    if ( m.type !== 'end' ){ return }\n\n    const transition = createTransitionFromFrame( m.start.time, m.time, m.frame, prevState )\n\n    m.transition = transition\n    m.start.transition = transition\n\n    prevState = { ...prevState, ...transition.endState }\n  })\n\n  prevState = defaultState\n\n  // assign a reduced end state to each marker\n  timeline.forEach( m => {\n    if ( m.type !== 'end' ){ return }\n\n    const transitions = getTransitionsAtTime( timeline, m.time )\n\n    prevState = reduceTransitions( schema, transitions, m.time, prevState )\n    m.state = prevState\n  })\n\n  const conflicts = getConflictingFrames( timeline )\n\n  if ( conflicts ){\n    throw new Error('The following overlapping frames modify the same state paths:\\n' +\n      `paths: ${conflicts.paths}\\n` +\n      `frames: ${JSON.stringify(conflicts.frames, null, 2)}`\n    )\n  }\n\n  return timeline\n}\n\n// Get transition information needed\n// at specified time from timeline\n// ---------------------------------------\nexport function getTransitionsAtTime( timeline, time ){\n  const markers = []\n  let idx\n\n  for ( let l = timeline.length, i = 0; i < l; i++ ){\n    const m = timeline[i]\n\n    if ( m.time >= time ){\n      break\n    }\n\n    if ( m.type === 'start' ){\n      markers.push( m )\n    } else {\n      // stop tracking its partner\n      idx = markers.indexOf( m.start )\n      markers.splice( idx, 1 )\n    }\n  }\n\n  return markers.map(a => a.transition)\n}\n\n// Get the cached complete state at the\n// last end marker\n// ---------------------------------------\nexport function getStartState( timeline, time, defaultState ){\n  let state = defaultState\n\n  for ( let l = timeline.length, i = 0; i < l; i++ ){\n    const m = timeline[i]\n\n    if ( m.time > time ){\n      return state\n    }\n\n    if ( m.type === 'end' ){\n      state = m.state\n    }\n  }\n\n  return state\n}\n\n// Get final state from transitions\n// ---------------------------------------\nexport function reduceTransitions( schema, transitions = [], time = 0, initialState = {} ){\n  return transitions.reduce( (state, tr) => {\n    const progress = getTimeFraction( tr.startTime, tr.endTime, time )\n\n    return Object.assign(\n      state\n      , getInterpolatedState( schema, tr.startState, tr.endState, progress, tr.easing )\n    )\n  }, { ...initialState })\n}\n","import { pick, clamp } from '@/util'\n\nexport function createTransitionFromFrame( startTime, endTime, frame, previousState ){\n  const endState = frame.state\n  const startState = pick( previousState, Object.keys(endState) )\n  const easing = frame.meta.easing\n\n  return {\n    startTime\n    , endTime\n    , startState\n    , endState\n    , easing\n    , frame\n  }\n}\n\nexport function interpolateProperty( fn, from, to, progress, opts = {} ){\n  return fn( from, to, progress, opts )\n}\n\nexport function getInterpolatedState( schema, startState, endState, timeFraction, easing ){\n\n  if ( timeFraction <= 0 ){\n    return { ...startState }\n  }\n\n  if ( timeFraction >= 1 ){\n    return { ...endState }\n  }\n\n  const nextState = { ...startState }\n\n  for ( const prop in endState ){\n    const def = schema[prop]\n    let val\n\n    if ( !def ){\n      // not specified in schema. just set\n      val = endState[prop]\n    } else {\n      easing = easing || def.easing\n      const progress = easing( timeFraction )\n\n      val = interpolateProperty(\n        def.interpolator\n        , nextState[prop]\n        , endState[prop]\n        , progress\n        , def.interpolatorOpts\n      )\n    }\n\n    nextState[prop] = val\n  }\n\n  return nextState\n}\n\nexport function getTimeFraction( startTime, endTime, time ){\n  const duration = endTime - startTime\n  const frac = duration ? (time - startTime) / duration : 1\n\n  return clamp(0, 1, frac)\n}\n","import * as Interpolators from '@/interpolators'\n\nexport const NATIVE_TYPES = {\n  'number': {\n    type: 'number'\n    , default: 0\n    , interpolator: Interpolators.linear\n  }\n  , 'string': {\n    type: 'string'\n    , default: ''\n    , interpolator: Interpolators.string\n  }\n  , 'boolean': {\n    type: 'boolean'\n    , default: false\n    , interpolator: Interpolators.toggle\n  }\n  , 'array': {\n    type: 'array'\n    , default: []\n    , interpolator: Interpolators.array\n  }\n  , 'object': {\n    type: 'object'\n    , default: {}\n    , interpolator: Interpolators.object\n  }\n}\n\nconst CUSTOM_TYPES = {}\n\nexport function registerType( cfg ){\n  const { type, interpolator } = cfg\n\n  if ( !type || !interpolator ){\n    throw new Error('Custom types must have \"type\" and \"interpolator\" specified')\n  }\n\n  if ( CUSTOM_TYPES[type] ){\n    throw new Error(`Custom type \"${type}\" is already registered`)\n  }\n\n  CUSTOM_TYPES[type] = {\n    type\n    , interpolator\n    , default: cfg.default\n  }\n}\n\nexport function getType( val ){\n  const type = typeof val\n\n  if ( type === 'string' ){\n    return val\n  }\n\n  if ( val === Number || type === 'number' ){\n    return 'number'\n  }\n\n  if ( val === Boolean || type === 'boolean' ){\n    return 'boolean'\n  }\n\n  if ( val === String ){\n    return 'string'\n  }\n\n  if ( val === Array || Array.isArray( val ) ){\n    return 'array'\n  }\n\n  if ( val === Object ){\n    return 'object'\n  }\n\n  if ( type === 'object' ){\n    throw new Error('Can not use implicit definition for objects or custom types')\n  }\n\n  return type\n}\n\n// determine if the schema declaration is an explicit declaration\n// of the type. eg: (type: 2) is implicit number\nexport function isExplicit( type, val ){\n  if ( type === 'string' ){\n    return val === 'string' || val === String\n  }\n\n  if ( type === 'number' ){\n    return val === 'number' || val === Number\n  }\n\n  if ( type === 'boolean' ){\n    return val === 'boolean' || val === Boolean\n  }\n\n  if ( type === 'array' ){\n    return val === 'array' || val === Array\n  }\n\n  if ( type === 'object' ){\n    return val === 'object' || val === Object\n  }\n\n  return true\n}\n\nexport function getTypeCfg( type ){\n  return NATIVE_TYPES[type] || CUSTOM_TYPES[type]\n}\n","export const identity = a => a\n\n// From js - https://github.com/tweenjs/tween.js/blob/master/src/Tween.js\n// Include a performance.now polyfill.\n// In node.js, use process.hrtime.\nexport const now = (() => {\n  if (typeof (window) === 'undefined' && typeof (process) !== 'undefined') {\n    return function now() {\n      var time = process.hrtime()\n\n      // Convert [seconds, nanoseconds] to milliseconds.\n      return time[0] * 1000 + time[1] / 1000000\n    }\n  } else if (typeof (window) !== 'undefined' &&\n      window.performance !== undefined &&\n      window.performance.now !== undefined ) {\n    // In a browser, use window.performance.now if it is available.\n    // This must be bound, because directly assigning this function\n    // leads to an invocation exception in Chrome.\n    return window.performance.now.bind(window.performance)\n  } else if (Date.now !== undefined) {\n    // Use Date.now if it is available.\n    return Date.now\n  } else {\n    // Otherwise, use 'new Date().getTime()'.\n    return function now() {\n      return new Date().getTime()\n    }\n  }\n})()\n\nexport const castArray = function( thing ){\n  return Array.isArray(thing) ? thing : [thing]\n}\n\nexport const lerp = function( from, to, t ){\n  return from * ( 1 - t ) + to * t\n}\n\n// clamp\nexport const clamp = function( min, max, v ){\n  return Math.min(Math.max(v, min), max)\n}\n\nexport const mapProperties = function( obj, fn ){\n  return Object.keys( obj ).reduce( (ret, key) => {\n    ret[key] = fn(obj[key], key)\n    return ret\n  }, {} )\n}\n\nexport const pick = function( obj, keys = [] ){\n  if ( !keys ){\n    // all\n    return { ...obj }\n  }\n  return keys.reduce( (out, k) => {\n    out[k] = obj[k]\n    return out\n  }, {})\n}\n\n// Only take properties that are present in\n// first object\n// ---------------------------------------\nexport const mergeIntersecting = function( first, second ){\n  return {\n    ...first\n    , ...pick(\n      second\n      , Object.keys(first)\n    )\n  }\n}\n\n/**\n * util.sortedIndex( array, value[, callback] ) -> Number\n * - array (Array): The array to inspect\n * - value (Mixed): The value to evaluate\n * - callback (Function): Function called per iteration\n * - retHighest (Boolean): Specify returning the highest qualified index\n *\n * Implementation of [lodash.sortedIndex](http://lodash.com/docs#sortedIndex).\n **/\nexport const sortedIndex = function( array, value, callback, retHighest ) {\n  let low = 0\n  let high = array ? array.length : low\n\n  // explicitly reference `identity` for better inlining in Firefox\n  callback = callback || identity\n  value = callback(value)\n\n  while (low < high) {\n    const mid = (low + high) >>> 1\n    const computed = callback(array[mid])\n\n    if ( retHighest ? (computed <= value) : (computed < value) ){\n      low = mid + 1\n    } else {\n      high = mid\n    }\n  }\n\n  return low\n}\n\nexport const getIntersectingPaths = function ( o1, o2 ){\n  return Object.keys(o1).filter(\n    Object.prototype.hasOwnProperty.bind( o2 )\n  )\n}\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import * as Easing from '@/easing'\nimport * as util from '@/util'\nimport Manager from '@/manager'\nimport * as Interpolators from '@/interpolators'\nimport Player from '@/player'\nimport Syncher from '@/syncher'\nimport Parsers from '@/parsers'\nimport { getTimeFraction, interpolateProperty } from '@/transition'\nimport { Smoothener } from '@/animation/smoothener'\nimport { registerType } from '@/type'\nimport * as ENUM from '@/enum'\n\nconst Copilot = function( schema, meta ){\n  return new Manager( schema, meta )\n}\n\nCopilot.Util = util\nCopilot.Easing = Easing\nCopilot.Interpolators = Interpolators\nCopilot.Player = Player\nCopilot.Syncher = Syncher\nCopilot.Parsers = Parsers\nCopilot.registerType = registerType\nCopilot.Animation = { Smoothener, getTimeFraction, interpolateProperty }\nObject.assign(Copilot, ENUM)\n\nexport default Copilot\n"],"sourceRoot":""}